# Circular inference task

This task is written in PsychoPy. It has been developed in PsychoPy Builder v2022.1.2 (and is known to have backward compatibility issues with earlier versions of PsychoPy).
The subject aims to manoeuvre a "shield" or paddle around a circle to catch as many 'laser beams' as possible. This requires the subject to estimate the current mean of the generative distribution of the laser, and place their paddle as close as possible to this mean. They can adjust the paddle location using left and right keys.
They can also adjust the width of the paddle by using the upward and downward arrows. Increasing the width of the paddle will mean more laser beams are caught, but the participant will accumulate rewards at a slower rate as a result. The current rate of reward is indicated by the "redness" of the paddle, and the current total accumulated reward is displayed as text in the centre of the screen. (This can be easily deactivated in the builder mode).

## Stimulus generation
The laser directions are currently loaded into PsychoPy from a file named "rotation_stream.csv" in the folder stimgen. This is a two-column CSV - the first column contains the true generative mean of the distribution, and the second column contains the actual presented laser beam. Each row of the CSV represents one frame of the experiment, which will run for as many frames as there are rows in the CSV file. The CSV file is generated by the MATLAB script write_stimstream_file.m, which calls the function generate_outstream.m. This currently generates a gaussian random walk, with noisy observations resampled every N frames (where N is a poisson distribution).

## Installation
Although the repository contains an auto-generated .js version of the experiment, it currently only works in PsychoPy and has not been fully converted to PsychoJS. To run the PsychoPy version, you will need to (a) pull this repository to your computer; (b) open rotation_task.psyexp in Builder mode in PsychoPy, and edit the path to the CSV location in the "code" component so that it points to the correct location on your computer - i.e. edit the line which reads:
>(storedStream = pd.read_csv('/Users/lhunt/home/python/PsychoPy/experiments/rotation_task/stimgen/rotation_stream.csv',header=None);

(c) press Play in builder mode to compile the PsychoPy code - it should (hopefully) run!

## To Do
Here are some things that need to be done before this experiment is useable:
> - relevant variables are now being written to CSV file, but this needs to now be stored in a separate location for each subject (currently in "savedData.csv")
> - modify the JS part of the "code" component so that the experiment is useable online as well as in-person
> - modify stimulus generation to have more interesting manipulations, allow multiple runs per subject etc
> - add in clearer representation of accumulated reward than simple text display
> - add in trigger generation for running EEG/MEG version of experiment

LH 21/04/2022
